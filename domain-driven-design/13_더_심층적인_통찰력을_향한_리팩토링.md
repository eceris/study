# 더 심층적인 통찰력을 향한 리팩토링

더 심층적인 통찰력을 향한 리팩토링을 시작하는 방식 
- **복잡하거나 부자연스러운 기능**을 코드상에서 발견하고 **해결**하고자 할때
- 어떤 개념이 누락되어 **도메인 모델**이 **어색**한 경우
- 도메인 전문가가 이해하지 못하는 용어를 사용해서 작성되어 있거나 **새로운 요구사항**을 자연스럽게 받아들이지 못하는 경우

### 선행기술

항상 바퀴를 다시 발명할 필요는 없다. 누락된 개념을 발견하고 더 나은 모델을 위한 브레인 스토밍 과정은....

1. 가능한 모든 출처로부터 아이디어를 흡수하고,
2. 흡수한 아이디어와 지엽적인 지식을 결합하며,
3. 현재 직면한 문제의 해답을 찾는 탐구 과정을 지속할 수 있게 만들어준다.

> 선행 기술은 서적이나 도메인 자체에 대한 지식을 정리해놓은 문서에서도 자료를 얻을 수 있다. 분석 패턴의 형태로 경험을 활용 할 수 있다.(분석패턴은 명확하게 소프트웨어 개발에 적합한 형태를 띠고 있으며 직접적으로 현재 도메인의 소프트웨어를 개발한 경험을 기반으로 한다.) 분석패턴이 모든 것에 은총알은 아니다. 단지 **지식탐구 프로세스**를 **제공**하는 것 일 뿐.

### 개발자를 위한 설계

소프트웨어는 사용자만을 위한 것이 아니다. 개발자를 위한 것 이기도 하다.

> 유연한 설계는 사용자에게 가장 핵심적인 부분을 세밀하게 표현하는 심층적인 도메인 모델에 기반을 둔다. 이것은 변경이 **가장 빈번하게 일어나는 부분은 유연하게 유지하고 자주 변경되지 않는 부분은 단순하게 만드는 데 도움이 된다.**

### 타이밍

변경을 완벽하게 정당화할 수 있을 때까지 기다린다면 지나치게 오랫동안 기다린 셈이다.

더 심층적인 통찰력을 향한 리팩토링은 도메인의 주요 주제를 지속적으로 조사하고, 개발자들을 교육하며, 개발자와 도메인 전문가가 의견의 일치를 이루는 과정의 일부가 되어야 한다. 따라서 아래와 같은 경우에 리팩토링을 실시한다. 

1. 현재 팀에서 도메인을 이해하고 있는 바가 설계에 표현되어 있지 않은 경우
2. 중요한 개념이 설계상에 암시적으로 표현되어 있는 경우
3. 설계상의 중요한 부분을 더욱 유연하게 만들 기회가 보이는 경우

> 출시 전날에는 리팩토링을 해서는 안된다. 도메인의 `핵심` 을 찌르지 못하면서 단지 기술적인 기교를 뽑내기 위한 **"유연한 설계"**를 도입해서는 안된다.

### 위기를 기회로
다윈의 진화론이 1970년대에 **"단속평행론"**으로 변경된 것처럼 소프트웨어 개발 역시 이와 유사한 종류의 리듬을 따른다.

> 단속 평행론 : 진화의 확장된 관점에서 오랜기간동안의 점진적인 변화나 안정성은 상대적으로 짧은 기간의 폭발적이면서 신속한 변화로 중단된다. 그 후 종은 새로운 평형상태에 안착한다.

더 심층적인 통찰력을 향한 리팩토링은 지속적인 과정이다.

