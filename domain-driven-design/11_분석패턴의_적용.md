# 분석패턴의 적용

심층모델과 유연한 설계는 쉽게 얻을 수 있는 것이 아니다. 도메인에 대한 장기간의 학습과 풍부한 대화, 수많은 시행착오를 거쳐 개선이 이루어 진다. 숙련된 개발자들은 **도메인 문제**를 관찰하던 도중 익숙한 종류의 **책임**이나 **관계**를 발견하면 **과거의 경험**<sup>분석 패턴</sup>을 활용하려 한다. 이러한 경험들이 모여 분석 패턴을 형성한다. 

> 분석 패턴은 업무 모델링 과정에서 발견되는 공통적인 **구조를 표현하는 개념의 집합**이다. 
> 분석패턴은 파악하기 힘든 도메인을 다뤄야 하는 사람들에게 소프트웨어를 성장시킬수 있는 가치있는 출발점이다. 
> 분석 패턴이라는 이름은 분석 패턴이 지닌 개념적인 본질을 강조한다.(기술적인 해법이 아닌 특정 도메인의 모델을 작성할 때 따를 수 있는 유용한 지침서)

최상의 분석 패턴은 과거의 프로젝트에서 유용한 경험을 전달하고 모델에 대한 통찰력을 광범위한 설계 방침과 구현 결과에 결합시킨다.

예 : 계좌의 이자 수익 (회계 모델 적용)

> 항상 부딪히게 되는 현실의 문제를 해결하기 위해 적절한 절충안을 찾고, 찾아낸 절충안을 바탕으로 MODEL-DRIVEN DESIGN의 길에서 벗어나는 일 없이 앞으로 나아가야 한다.

### 기입 규칙
회계 시스템에서 상호 연관된 규칙을 기반으로 대다수의 계정 항목을 생성하게 되는데 신중하게 하더라도 서로 의존하는 로직이 뒤죽박죽 될 가능성이 높다. 이런 의존성을 완화하고자 새로운 객체를 추가해서 규칙을 명확하게 한다.(기입 규칙 객체)

### 기입 규칙 실행
의존성을 설계할 때 까다로운 부분 중 하나는 갱신의 **시기**와 **제어 방식**이다.
1. **"적극적인 실행"** 명확하지만 가장 비효율적.(Account 에 Entry가 삽입될 때마다 바로 Posting Rule을 싱행하므로 모든 갱신이 즉시 이루어짐.)
2. "Account 기반 실행" 방식은 처리시기를 연기. 특정시점에 Account로 메시지가 전달되고, Posting Rule이 실행된 후에 삽입된 모든 Entry를 처리한다.
3. "Posting-Rule 기반 실행" Posting Rule을 실행하는 외부 에이전트에 의해 실행. 마지막으로 수행한 이후에 추가된 Entry를 모두 찾아야 하는 책임이 있음 


## 분석 패턴은 참고할 수 있는 지식이다. 
분석패턴이라는 것이 **정형화된 틀**이 아니고 **경험적**으로 얻어낸 **특정 패턴**(플로우)인 것 같다.

널리 알려진 분석 패턴을 적용할 때에는 패턴의 외견상의 형태는 변경해도 무방하지만, 패턴이 의미하는 기본적인 개념만큼은 손대지 말아야 한다. 
왜냐하면...

1. 패턴에는 문제의 발생을 미연에 방지 할 수 있는 지식이 포함되어 있다.
2. 널리 이해되거나 적어도 잘 설명된 용어를 포함시킴으로써 UBIQUITOUS LANGUAGE를 발전시킬 수 있다.

> 개선된 **분석 패턴**은 **가치가 높고** 계속해서 바퀴<sup>boiiler plate</sup>를 다시 발명하는 시간을 절약하는데 도움이 된다.
> 모델은 전체적으로 동작하는 하나의 완전한 기능인데 비해, 분석 패턴은 모델의 일부를 구성하는 부속품에 불과하다. 하지만, 그것이 없다면 알아내는데 큰 비용이 드는 **하부 활동에 대한 영향력**을 **예측**할 수 있게 해준다.
