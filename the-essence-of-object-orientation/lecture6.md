# 객체 지도

지도 은유의 핵심은 **기능** 이 아니라 **구조** 를 기반으로 모델을 구축하는 것이 좀 더 범용적이고 **변경에 안정적** 이라는 것

객체지향 개발방법은 전통적인 방법과 다르게 안정적인 구조에 변경이 빈번하게 발생하는 기능을 종속시키는 지도의 방법과 유사.
즉, 안정적인 구조를 기반으로 시스템을 구조화.


### 기능 설계 대 구조 설계

소프트웨어 제품의 설계에는 기능측면의 설계와 구조측면의 설계로 이루어진다. 
- 기능 측면의 설계 : 제품이 사용자를 위해 무엇을 할 수 있는지에 대한 설계
- 구조 측면의 설계 : 제품의 형태가 어떠해야 하는가에 대한 설계

훌륭한 기능이 소프트웨어를 만드는 충분조건이라면, 훌륭한 구조는 필요조건.

소프트웨어 분야에서 예외가 없는 유일한 규칙은 **요구 사항이 항상 변경된다는 것** 이다.

설계가 어려운 이유는 어제 약속했던 기능을 제공하는 동시에 내일 변경될지도 모르는 요구사항도 수용할 수 있는 코드를 창조해야 하기 때문.

> 설계를 하는 목적은 나중에 설계하는 것을 허용하는 것이며, 설계의 일차적인 목표는 변경에 소요되는 비용을 낮추는 것이다.

> \- Metz 2012

#### 기능 분해의 차이
전통적인 기능 분해

1. 자주 변경되는 기능을 중심으로 설계한 후 구조가 기능을 따르게 함.
2. 각 기능은 서로 밀접하게 관련되어 하나의 덩어리를 이루기 때문에, 기능이 변경될 경우 기능의 축을 따라 설계된 소프트웨어가 전체적으로 요동친다.

객체지향 접근을 통한 기능 분해

1. 자주 변경되지 않는 안정적인 객체 구조를 바탕으로 시스템의 기능을 **객체 간의 책임** 으로 분배.
2. 객체의 구조에 집중하고 기능이 객체의 구조를 따르게 함.
3. 시스템 기능은 더 작은 책임으로 분할되고 적절한 객체에게 분배됨으로써 기능이 변경되어도 객체간의 구조는 그대로 유지.

---
### 두가지 재료 : 기능과 구조
- 기능 : 사용자가 자신의 목표를 달성하기 위해 사용할 수 있는 **시스템의 서비스** 이다.
- 구조 : 시스템의 **기능을 구현하기 위한 기반**으로 기능 변경을 수용할 수 있도록 **안정적**이어야 한다. 


#### 그럼 이 두 재료를 어떻게 표현하지?
- 기능 : 사용자의 목표를 만족시키기 위해 **책임** 을 수행하는 **시스템의 행위** 로 표현한다.
- 구조 : 사용자나 이해관계자들이 **도메인**<sup>domain</sup> 에 관해 생각하는 **개념과 개념들간의 관계** 로 표현한다.

일반적으로 기능을 수집하고 표현하기 위한 기법을 **유스케이스 모델링** 이라고 하고, 구조를 수집하고 표현하기 위한 기법을 **도메인 모델링** 이라고 한다.

---
### 안정적인 재료 : 구조
게임이나 은행 앱 처럼 특정 분야의 문제를 해결하기 위해 소프트웨어를 사용하는데 이처럼 사용자가 프로그램을 사용하는 **대상 분야** 를 **도메인**<sup>domain</sup>이라고 한다.

#### 도메인 모델이란?
도메인 모델 : 사용자가 프로그램을 사용하는 **대상 영역에 관한 지식**<sup>도메인</sup>을 선택적으로 **단순화** 하고 의식적으로 **구조화** 한 형태. 즉, 소프트웨어가 목적하는 영역 내의 **개념과 개념 간의 관계**, 다양한 **규칙**이나 **제약**을 주의 깊게 **추상화** 한 것.

#### 도메인 모델은 단순히 다이어그램이 아니다!
도메인 모델은 도메인에 대한 사용자 모델, 디자인 모델, 시스템 이미지를 포괄하도록 추상화한 소프트웨어 모델이다.

도메인 모델은 이해관계자들이 바라보는 **멘탈 모델**<sup>사람들이 자기 자신, 다른 사람, 환경, 자신이 상호작용하는 사물들에 갖는 모형</sup> 이다.

#### 도메인의 모습을 담을 수 있는 객체지향
최종 코드는 사용자가 도메인을 바라보는 관점을 반영해야 한다. 

객체지향을 이용하면 도메인에 대한 사용자모델, 디자인 모델, 시스템 이미지 모두가 유사한 모습으로 유지하도록 만드는 것이 가능하다. 
이런 특징을 **연결완전성** 또는 **표현적 차이** 라고 한다.

#### 표현적 차이
소프트웨어 객체는 현실 객체를 모방한 것이 아니라 **은유** 한 것이다. 보통은 소프트웨어 객체와 현실 객체 사이의 **의미적 거리** 인 **표현적 차이** 혹은 **의미적 차이** 가 존재하는데, 이것을 **은유**를 통해 최대한 차이를 줄이는 것이 **핵심**이다.

> 소프트웨어 객체를 창조하기 위해 우리가 **은유** 해야 하는 대상은 **도메인 모델** 이다. 이것이 **도메인 모델** 이 중요한 이유.

1. 도메인 모델을 이용하여 설계하고 구현하는 것은 사용자가 도메인을 바라보는 관점 그대로 코드에 반영한다는 의미.
2. 그러므로 사용자의 **멘탈모델**이 그대로 코드에 녹아 스며든다.
3. 결과적으로 **표현적 차이** 가 줄어들고 소프트웨어를 이해하고 수정하기 쉽게 만들어줌.
4. 코드가 도메인이고 도메인이 코드 이기 때문에 이해하기 쉽다.

#### 불안정한 기능을 담은 안정적인 도메인 모델
도메인 모델이 제공하는 구조가 상대적으로 **안정적** 이기 때문에, 도메인 모델을 기반으로 코드를 작성하는 것이 좋다.

> **본질적** 이라는 말이 나오는 데, 이것은 **변경**이 적고 비교적 그 특성이 **오랜 시간** 유지된다는 것을 의미. **도메인 모델**은 도메인의 **본질적인** 측면을 담고 있으므로 비교적 **안정적으로** 소프트웨어를 구현할 수 있다.

실제로 소프트웨어를 사용하는 사용자에게 중요한 것은 기능, 이러한 기능을 기술하기 위해 **유스케이스** 라는 툴을 이용.

---
### 불안정한 재료 : 기능

#### 유스케이스
훌룽한 기능적 요구사항을 얻기 위해서는 **목표**를 가진 사용자와 사용자의 목표를 만족시키기 위해 **일련의 절차**를 수행하는 시스템간의 **상호작용** 관점에서 시스템을 바라봐야 한다. 

> 이러한 사용자의 목표를 달성하기 위해 사용자와 시스템 간에 이뤄지는 상호작용의 흐름을 텍스트로 정리한 것을 **유스케이스** 라고 한다.

유스케이스의 가치는 **사용자들의 목표**를 중심으로 시스템의 기능적인 요구사항들을 **이야기 형식** 으로 묶을 수 있다는 것. 

> 사용자 목표가 유스케이스의 핵심이다. 유스케이스는 공통의 사용자 목표를 통해 강하게 연관된 시나리오의 집합이다.

> \- Fowler 2003

유스케이스의 특성

1. 사용자와 시스템 간의 상호작용을 보여주는 **텍스트**<sup>다이어그램이 아니다!!!</sup> 이다.
2. 하나의 시나리오가 아니라 **여러 시나리오들의 집합** 이다.
3. 유스케이스는 단순한 피처<sup>feature</sup> 목록과는 다르다.
4. 사용자 인터페이스와 관련된 **세부 정보**를 포함하지 **말아야** 한다.
5. **내부 설계**와 관련된 정보를 포함하지 **말아야** 한다.



#### 유스케이스는 설계 기법도, 객체지향 기법도 아니다.
사실 유스케이스는 객체지향과 직접적인 관련이 없다.

> 단지 사용자가 시스템을 통해 무엇을 엇을 수 있고, 어떻게 상호작용할 수 있느냐에 관한 정보만 기술한다.

---
### 재료합치기 : 기능과 구조의 통합

유스케이스는 불안정한 기능을 **서술** 하기 위해 가장 일반적으로 사용되는 **도구**이다.

시스템은 사용자 관점에서 자신이 전송한 메시지에 응답하는데 필요한 **책임**을 수행하는 일종의 **객체**이다. 결국 커다란 규모의 **책임**은 시스템 안에 살아가는 더 작은 크기의 객체들의 **협력**을 통해 구현될 수 있다.

객체 설계 

1. 요구사항들을 식별하고 도메인 모델을 생성.
2. 클래스에 메소드를 추가.
3. 요구사항을 충족시키기 위해 객체들 간의 메시지 전송을 정의.

##### 유스케이스의 역할
사용자에게 제공할 기능을 시스템의 책임으로 보게 함으로써 객체간의 안정적인 구조에 책임을 분배할 수있는 출발점을 제공

#### 도메인 모델의 역할
기능을 수용하기 위해 은유할 수 있는 안정적인 구조를 제공.

**책임-주도 설계**는 **유스케이스**로부터 첫 번째 메시지와 사용자가 달성하려는 **목표**를, **도메인 모델**로부터 기능을 수용할 수 있는 **안정적인 구조**를 제공받아 실제로 동작하는 객체들의 **협력 공동체**를 창조한다.


개발자는 유스케이스를 통해 **기능**이라는 단어를 머릿속에서 **책임**이라는 단어로 대체. 

#### 기능 변경을 흡수하는 안정적인 구조

도메인 모델이 안정적인 이유

1. 도메인 모델을 구성하는 개념은 비지니스가 없어지거나 완전히 개편되지 않는 한 안정적으로 유지된다.
> 정기 예금 도메인에서 **정기 예금**과 **계좌, 이자율, 이자** 란 개념은 정기예금이라는 금융상품이 없어지거나 완전히 개편되지 않는 한 안정적으로 유지.

2. 도메인 모델을 구성하는 **개념 간의 관계**는 비지니스 규칙을 기반으로하기 때문에 비지니스 **정책이 크게 변경되지 않는 한 안정적**으로 유지된다.
> 정기예금 도메인에서 이자는 정기예금이 만기가 되거나 중도 해지를 하는 경우에 한해서 한 번 지급. 따라서 **계좌** 와 **이자** 간의 0..1 관계는 이와 같은 핵심적인 비지니스 규칙이 변경되지 않는 한 동일하게 유지.


#### 연결 완전성
도메인을 모델링하기 위한 기법과 도메인을 프로그래밍 하기 위한 기법이 동일. 도메인 모델에서 객체와 개념을 프로그래밍의 객체와 클래스로 매끄럽게 변환가능함.

#### 가역성<sup>reversibility</sup>
연결완전성과 반대로 코드에서 모델로의 매끄러운 흐름을 의미.


> 도메인 모델은 문서나 다이어그램이 아니다. 사람들의 머릿속에 들어있는 공유된 **멘탈 모델**이다.
